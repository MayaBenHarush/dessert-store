<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>LLM — קוד שנוצר בעזרת בינה מלאכותית</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="/assets/styles.css" />
  <style>
    .llm-container{max-width:1000px;margin:0 auto;background:var(--bg-card);padding:40px;border-radius:20px;box-shadow:var(--shadow-lg);line-height:1.8}
    .llm-section{margin-bottom:30px;padding:20px 0;border-bottom:1px solid #eee}
    .llm-section:last-child{border-bottom:none}
    .llm-section h2{color:var(--primary-color);margin-bottom:12px}
    .hint{background:var(--bg-primary);border-right:4px solid var(--primary-color);padding:12px;border-radius:10px;margin:10px 0;color:var(--fg-muted)}
    .files-table{width:100%;border-collapse:collapse;margin:10px 0 0}
    .files-table th,.files-table td{padding:10px;border-bottom:1px solid #ececec;text-align:right;vertical-align:top}
    .tag{display:inline-block;background:#eef;border:1px solid #ccd;padding:.1rem .5rem;border-radius:999px;font-size:.8rem;margin-left:.3rem}
    details.code-block{margin:10px 0;border:1px solid #eee;border-radius:12px;overflow:hidden;background:#fafafa}
    details.code-block[open]{box-shadow:0 8px 20px rgba(0,0,0,.06)}
    details.code-block summary{cursor:pointer;list-style:none;padding:12px 14px;background:#fff;font-weight:700;display:flex;align-items:center;gap:8px}
    details.code-block summary::-webkit-details-marker{display:none}
    .code-meta{font-size:.9rem;color:#666;font-weight:500}
    .code-wrap{position:relative}
    pre{margin:0;padding:14px 16px;overflow:auto;background:#0b1021;color:#e2e8f0;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace}
    .copy-btn{position:absolute;top:8px;left:8px;background:#222;color:#fff;border:none;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:.8rem;opacity:.9}
    .copy-btn:hover{opacity:1}
    .pill{display:inline-flex;gap:8px;align-items:center;font-size:.85rem}
    .ok{color:#2e7d32}
    .warn{color:#b26a00}
    .muted{color:#6b7280}
  </style>
</head>
<body>
  <nav>
    <a href="store.html">חנות</a>
    <a href="cart.html">סל הקניות</a>
    <a href="checkout.html">תשלום</a>
    <a href="myitems.html">הרכישות שלי</a>
    <a href="readme.html">📖 README</a>
    <a id="login-link" href="login.html">התחברות</a>
    <button id="logout" style="display:none">התנתקות</button>
    <a id="admin-link" href="admin.html" style="display:none">ניהול</a>
    <button id="theme-toggle">🌙 מצב כהה</button>
    <button id="language-toggle" style="display:none">🌐 English</button>
  </nav>

  <div class="llm-container">
    <h1> LLM — קוד קטן שסייע לי (רוב העבודה בוצעה ידנית)</h1>

    <div class="hint">
      להלן כמה מקטעים נקודתיים בהם נעזרתי ב-LLM. שאר הפיתוח — תכנון, כתיבה, אינטגרציה ובדיקות — נעשה על-ידי.
    </div>

    <!-- 1) תרגום קטן -->
    <section class="llm-section" id="i18n">
      <h2>1) תרגום קטן של מפתחות UI</h2>
      <p class="pill muted">היקף: קטן מאוד • מטרה: ניסוח מדויק באנגלית לשני מפתחות קיימים</p>
      <table class="files-table">
        <thead><tr><th>קובץ</th><th>תיאור</th><th>למה השתמשתי ב-LLM</th><th>סטטוס</th></tr></thead>
        <tbody>
          <tr>
            <td><code>assets/translations.js</code> (מקטע)</td>
            <td>הוספת שני מפתחות תרגום (he/en)</td>
            <td>עזרה בבחירת ניסוח אנגלי קצר ותקני</td>
            <td><span class="ok">שולב</span></td>
          </tr>
        </tbody>
      </table>

      <details class="code-block">
        <summary>הצג קוד (קטע קצר)</summary>
        <div class="code-wrap">
          <button class="copy-btn" data-target="code-i18n">העתק</button>
          <pre id="code-i18n">// assets/translations.js (snippet)
const i18n = {
  he: {
    "pageTitle.admin": "מסך ניהול",
    "nav.diy": "עשה זאת בעצמך"
  },
  en: {
    "pageTitle.admin": "Admin",
    "nav.diy": "DIY"
  }
};
// הערה: ה-LLM סייע לבחור ניסוח תמציתי וקוהרנטי באנגלית.</pre>
        </div>
      </details>
    </section>

    <!-- 2) ניהול — סנכרון מחירים -->
    <section class="llm-section" id="admin-prices">
      <h2>2) ניהול — סנכרון מחירים מוצגים מול נתוני אמת</h2>
      <p class="pill muted">היקף: קטן • מטרה: הימנעות מ-0₪ בתצוגה והשלמת מחיר ברירת מחדל עקבית</p>
      <table class="files-table">
        <thead><tr><th>קובץ</th><th>תיאור</th><th>למה השתמשתי ב-LLM</th><th>סטטוס</th></tr></thead>
        <tbody>
          <tr>
            <td><code>admin.html</code> (מקטע)</td>
            <td><code>getProductPrice()</code> + מפת מחירים בסיסית</td>
            <td>סיוע בניסוח לוגיקה קצרה ואחידה בין דפים</td>
            <td><span class="ok">שולב</span></td>
          </tr>
        </tbody>
      </table>

      <details class="code-block">
        <summary>הצג קוד (קטע תואם לדף הניהול)</summary>
        <div class="code-wrap">
          <button class="copy-btn" data-target="code-admin">העתק</button>
          <pre id="code-admin">// admin.html (snippet) — לוגיקת מחיר עקבית
const FALLBACK_PRICES = {
  "white-chocolate-cookie": 17,
  "white-design-cake": 140,
  "chocolate-cake": 150,
  "cookies-box": 120,
  "cupcakes": 160,
  "minnie-mous-cake": 300,
  "nutella-box": 70
};

function getProductPrice(p){
  if (typeof p.price === "number" && p.price > 0) return p.price;
  const guess = /(cookie|עוגי)/i.test((p.id||"") + " " + (p.title||"")) ? 17 : 100;
  return FALLBACK_PRICES[p.id] ?? guess;
}

// שימוש בתצוגה:
const productPrice = `₪${getProductPrice(p)}`;

// הערה: ה-LLM סייע לנסח את ההשמה העקבית וה-fallback הקטן.</pre>
        </div>
      </details>

      <details class="code-block">
        <summary>הצג קוד (חד-פעמי לעדכון מחירים חסרים)</summary>
        <div class="code-wrap">
          <button class="copy-btn" data-target="code-admin-init">העתק</button>
          <pre id="code-admin-init">// admin.html (snippet bottom) — ריצה חד-פעמית לעדכון מוצרי 0₪
async function updateExistingProductPrices(){
  try{
    const res = await fetch('/api/admin/products');
    if(!res.ok) return;
    const products = await res.json();

    const PRICE_MAP = {
      "white-chocolate-cookie": 17,
      "white-design-cake": 140,
      "chocolate-cake": 150,
      "cookies-box": 120,
      "cupcakes": 160,
      "minnie-mous-cake": 300,
      "nutella-box": 70,
      "chocolate-pizza-xl": 120,
      "bento-design-cake": 140,
      "chocolate-design-cake": 180,
      "orange-cake": 70,
      "pizza-cookie": 120
    };

    for(const product of products){
      if(!product.price || product.price === 0){
        const price = PRICE_MAP[product.id] || (/(cookie|עוגי)/i.test(product.id + ' ' + product.title) ? 17 : 100);
        await fetch(`/api/admin/products/${encodeURIComponent(product.id)}`, {
          method: 'PUT',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ ...product, price })
        });
      }
    }
    await loadProducts();
  }catch(err){ console.error('Error updating prices:', err); }
}
// הערה: ה-LLM סייע לקצר את הלולאה וה-fallback. הופעל פעם אחת בלבד.</pre>
        </div>
      </details>
    </section>

    <!-- 3) גלגל מזל — קופון תואם תוצאה -->
    <section class="llm-section" id="wheel-coupon">
      <h2>3) גלגל מזל — קופון תואם בדיוק לפרס שעליו נעצר הגלגל</h2>
      <p class="pill muted">היקף: קטן • מטרה: למנוע פער בין ה-UI לבין מה שנשמר בשרת</p>
      <table class="files-table">
        <thead><tr><th>קובץ</th><th>תיאור</th><th>למה השתמשתי ב-LLM</th><th>סטטוס</th></tr></thead>
        <tbody>
          <tr>
            <td><code>wheel.html</code> (מקטע)</td>
            <td>שליחת קוד הפרס המדויק שהמחוג נחת עליו</td>
            <td>סיוע בכתיבה תמציתית של השליחה לשרת</td>
            <td><span class="ok">שולב</span></td>
          </tr>
        </tbody>
      </table>

      <details class="code-block">
        <summary>הצג קוד (מיפוי פרס → קוד קופון ושליחה לשרת)</summary>
        <div class="code-wrap">
          <button class="copy-btn" data-target="code-wheel">העתק</button>
          <pre id="code-wheel">// wheel.html (snippet)
const PRIZES = [
  { label: "5% הנחה", code: "WHEEL5" },
  { label: "10% הנחה", code: "WHEEL10" },
  { label: "לא זכית", code: "NOWIN" },
  { label: "₪20 מתנה", code: "GIFT20" }
];

function onWheelStopped(segmentIndex){
  const prize = PRIZES[segmentIndex];
  // שליחה לשרת — שומר בדיוק את מה שהמחוג בחר
  fetch('/api/wheel/spin', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ prizeCode: prize.code })
  })
  .then(r => r.json()).then(data => {
    // הצגת פידבק למשתמש
    showToast(prize.label);
  })
  .catch(console.error);
}
// הערה: ה-LLM עזר לנסח את השיוך הפשוט ולוודא עקביות בין התצוגה לשרת.</pre>
        </div>
      </details>
    </section>

    <!-- 4) קליל: כפתור העתקה לבלוקי קוד בדף הזה -->
    <section class="llm-section" id="utils">
      <h2>4) עזר קטן בתוך הדף הזה — כפתור "העתק" לבלוקי קוד</h2>
      <p class="pill muted">היקף: מזערי • מטרה: נוחות הצגה בלבד</p>
      <details class="code-block">
        <summary>הצג קוד (Utility קצר)</summary>
        <div class="code-wrap">
          <button class="copy-btn" data-target="code-copy">העתק</button>
          <pre id="code-copy">// llm.html (snippet) — כפתור "העתק" לבלוקי קוד
document.addEventListener('click', (e) => {
  const btn = e.target.closest('.copy-btn');
  if(!btn) return;
  const targetId = btn.getAttribute('data-target');
  const pre = document.getElementById(targetId);
  if(!pre) return;
  const text = pre.textContent;
  navigator.clipboard.writeText(text).then(() => {
    btn.textContent = 'הועתק!';
    setTimeout(() => btn.textContent = 'העתק', 900);
  });
});</pre>
        </div>
      </details>
      <p class="muted">מעבר לנוחות, אין שימוש בפרויקט עצמו — רק בדף התיעוד הזה.</p>
    </section>

    <div class="hint">
      זהו — אלו המקרים הבודדים בהם נעזרתי ב-LLM. כל השאר (מודולי שרת, זרימות, עיצוב, בדיקות, התממשקות לקבצי JSON וכו’) פותחו באופן עצמאי.
    </div>
  </div>

  <script>
    // Dark Mode (כמו בשאר הדפים)
    function loadUICustomization(){
      const theme = localStorage.getItem('theme') || 'light';
      const btn = document.getElementById('theme-toggle');
      if(theme==='dark'){document.body.classList.add('dark-theme');btn.textContent='☀️ מצב בהיר';}
      else{document.body.classList.remove('dark-theme');btn.textContent='🌙 מצב כהה';}
    }
    document.getElementById('theme-toggle').addEventListener('click',()=>{
      const dark = document.body.classList.contains('dark-theme');
      localStorage.setItem('theme', dark?'light':'dark');
      loadUICustomization();
    });

    // ניווט / כפתורי התחברות (יישור לקיים)
    async function setupAuthButtons(){
      const loginLink=document.getElementById('login-link');
      const logoutBtn=document.getElementById('logout');
      const adminLink=document.getElementById('admin-link');
      let loggedIn=false, username='';
      try{
        const r=await fetch('/api/session');
        if(r.ok){loggedIn=true; const d=await r.json(); username=d.username;}
      }catch{}
      loginLink.style.display=loggedIn?'none':'';
      logoutBtn.style.display=loggedIn?'':'none';
      adminLink.style.display=(loggedIn && username==='admin')?'':'none';
    }
    document.getElementById('logout').onclick=async ()=>{
      try{await fetch('/api/logout',{method:'POST'});}finally{location.href='login.html';}
    };

    // Utility "העתק" (פועל גם בלי שינוי)
    document.addEventListener('click', (e) => {
      const btn = e.target.closest('.copy-btn');
      if(!btn) return;
      const targetId = btn.getAttribute('data-target');
      const pre = document.getElementById(targetId);
      if(!pre) return;
      const text = pre.textContent;
      navigator.clipboard.writeText(text).then(() => {
        btn.textContent = 'הועתק!';
        setTimeout(() => btn.textContent = 'העתק', 900);
      });
    });

    loadUICustomization();
    setupAuthButtons();
  </script>
</body>
</html>
